!================================================================================
!================================================================================
program optLE
!
  implicit none
  write(*,*) ""
  write(*,*) "++++++++++++++++++++++++++++++ optLE ++++++++++++++++++++++++++++++"
  !................................................................................
  call system("date")
  !................................................................................
  call init_random_seed
  !................................................................................
  call read_input
  !................................................................................
  call init_Pref ! P(x,v,t)
  !................................................................................
  call init_mass
  !................................................................................
  call init_potential
  !................................................................................
  call init_friction
  ! TODO: analysis of VACF, to assess need of memory, as in Lee,Ahn,Darve 2015 https://doi.org/10.1557/opl.2015.185
  ! TODO: estimate memory kernel in the wells as in Daldrop PNAS 18
  ! TODO: initial test of timestep (using harmonic well and testing temperature???)
  !................................................................................
  call print_profiles ! write initial F(x), gamma(x), mass(x) to file PROFILES
  !................................................................................
  ! if file "colvar_daldrop" exists, estimate friction as Daldrop-PNAS-18 and exit
  call friction_daldrop
  !................................................................................
  call optimize_Pmod
  ! TODO: ask Gaussian or flat scaling factors in input (now, default is Gaussian)
  !................................................................................
  call system("date")
  write(*,*) ""
  write(*,*) "++++++++++++++++++++++++++++ end ++++++++++++++++++++++++++++++++++"
  write(*,*) ""
!
end program optLE
!================================================================================
!================================================================================
